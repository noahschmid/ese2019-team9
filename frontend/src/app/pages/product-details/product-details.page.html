<ion-header>
	<ion-toolbar>
		<app-header></app-header>
	</ion-toolbar>
</ion-header>
<ion-content>
	<ion-title *ngIf="!product && isLoading">
		... Loading ...
	</ion-title>
	<ion-title *ngIf="!product && !isLoading">
		Product doesn't exist!
	</ion-title>
	<ion-grid *ngIf="product">
		<ion-row>
			<ion-title>{{ product.name }}</ion-title>
		</ion-row>
		<ion-row>
			<ion-col class="product-image-container" size="12" size-md="6">
				<ion-thumbnail class="product-image"><ion-img [src]="product.image || 'https://lorempixel.com/300/300/cats/'"></ion-img></ion-thumbnail>
			</ion-col>
			<ion-col size="12" size-md="6">
				<ion-list lines="none">
					<ion-item class="ion-text-capitalize product-title">{{ product.name }}</ion-item>
					<ion-item>Price: <span slot="end">{{ product.price || 'not specified'}}</span></ion-item>
					<ion-item>Category: <span slot="end">{{ product.category.name }}</span></ion-item>
					<ion-item>Seller: <span slot="end">{{ product.seller.name }}</span></ion-item>
					<ion-item>Location: <span slot="end">{{ product.location || 'nowhere'}}</span></ion-item>
					<ion-button fill="empty" class="blueButton" (click) = "onClickBuy();" *ngIf="!orderingDetails && loggedIn">Order now</ion-button>
				</ion-list>
				<ion-card *ngIf="orderingDetails">
						<ion-card-header>
							<ion-card-title>Order this product</ion-card-title>
						</ion-card-header>
						<ion-card-content>
								<form [formGroup]="orderForm" (ngSubmit)="onOrder()">
										<app-input-form
										[inputForm]="orderForm" [givenName]="'startDate'" [text]="'From*'"
										[validationMessages]="validationMessages.fromDate"
										[type]="'text'" [inputMode]="'text'">
										</app-input-form>
										<app-input-form
										[inputForm]="orderForm" [givenName]="'endDate'" [text]="'To*'"
										[validationMessages]="validationMessages.toDate"
										[type]="'text'" [inputMode]="'text'">
										</app-input-form>
										<app-input-form
										[inputForm]="orderForm" [givenName]="'description'" [text]="'Description*'"
										[validationMessages]="validationMessages.description"
										[type]="'text'" [inputMode]="'text'">
										</app-input-form>
	
										<ion-button class="blueButton" fill="empty" type="submit"> Submit </ion-button>
								</form>
								<ion-button class="greyButton" fill="empty" color="danger" (click) = "onClickBuy();" *ngIf="orderingDetails">Cancel</ion-button>
						</ion-card-content>
					</ion-card>
			</ion-col>
		</ion-row>
		<ion-row>
			<ion-col size="12" size-md="6" >
				<span class="product-title">Description</span><br/>
				<ng-container *ngIf="product.description"> {{ product.description }} </ng-container>
				<ng-container *ngIf="!product.description"> This product does not have a description</ng-container>
			</ion-col>
			<ion-col size="12" size-md="6">
				<span class="product-title">Reviews</span>
				<ion-card>
						<ion-card-header>
								<ion-card-title>Write a review</ion-card-title>
							</ion-card-header>
				<ion-card-content>

						<form [formGroup]="reviewForm" (ngSubmit)="onSubmitReview()">
								<ion-icon *ngFor="let i of array(5)" class="rating"
								[name]="i>filledStars ? 'star-outline' : 'star'" (mouseenter)="fillTo(i)"
								(click)="onRatingChanged(i)"></ion-icon>
								
								<app-input-form
								[inputForm]="reviewForm" [givenName]="'comment'" [text]="'Comment'"
								[validationMessages]="validationMessages.comment"
								[type]="'text'" [inputMode]="'text'">
								</app-input-form>
		
								<ion-button class="blueButton" fill="empty" type="submit"> Submit </ion-button>
						</form>
				</ion-card-content>
				</ion-card>
				
				<span *ngFor="let review of product.reviews">
					<app-product-review [review]="review"></app-product-review>
				</span>
			</ion-col>
		</ion-row>
	</ion-grid>
</ion-content>